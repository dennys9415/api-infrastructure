<VirtualHost *:443>
    # Server Admin Email
    ServerAdmin admin@givinggap.org

    # Document Root
    DocumentRoot /var/www/html/platform-api/public
    
    # Server Name
    ServerName servername.com    
    # SSL Certificate Configuration
    Include /etc/letsencrypt/options-ssl-apache.conf

    <Directory /var/www/html/platform-api/public>
        AllowOverride All
        Options -Indexes +FollowSymLinks
        Require all granted

        # Inline rewrite rules
        RewriteEngine On
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule ^ index.php [QSA,L]
    </Directory>

    # Logs
    ErrorLog ${APACHE_LOG_DIR}/platform-error.log
    CustomLog ${APACHE_LOG_DIR}/platform-access.log combined

    # Redirect HTTP to HTTPS (Optional, if not handled elsewhere)
    RewriteEngine On
    RewriteCond %{HTTPS} off
    RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [END,NE,R=permanent]

    Include /etc/letsencrypt/options-ssl-apache.conf

    ServerAlias servername.com
    SSLCertificateFile /etc/letsencrypt/live/servername.com/fullchain.pem
SSLCertificateKeyFile /etc/letsencrypt/live/servername.com/privkey.pem
</VirtualHost>
</IfModule>